<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ListView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.control.Tooltip?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.shape.Circle?>
<?import javafx.scene.text.Font?>

<StackPane fx:id="rootPane" prefHeight="700.0" prefWidth="1000.0" stylesheets="@../styles/tinder-theme.css" xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1" fx:controller="client.controllers.MessagesController">

    <BorderPane style="-fx-background-color: white;">

        <left>
            <VBox prefWidth="320.0" styleClass="chat-sidebar" BorderPane.alignment="CENTER">
                <HBox alignment="CENTER_LEFT" spacing="10">
                    <padding><Insets top="20.0" right="20.0" bottom="20.0" left="20.0" /></padding>
                    <Button onAction="#backToHome" style="-fx-background-color: transparent; -fx-cursor: hand; -fx-text-fill: #aaa; -fx-font-size: 14px; -fx-font-weight: bold;" text="&lt; Back" />
                    <Label text="Chats" textFill="WHITE">
                        <font><Font name="System Bold" size="24.0" /></font>
                    </Label>
                </HBox>

                <VBox style="-fx-padding: 10;">
                    <TextField fx:id="searchField" promptText="TÃ¬m kiáº¿m..." styleClass="search-field" />
                </VBox>

                <ListView fx:id="userListView" styleClass="conversation-list-view" VBox.vgrow="ALWAYS" style="-fx-background-color: transparent;"/>
            </VBox>
        </left>

        <center>
            <StackPane>
                <VBox fx:id="placeholderArea" alignment="CENTER" spacing="20.0" style="-fx-background-color: #f8f9fa;">
                    <Label text="Chá»n má»™t ngÆ°á»i Ä‘á»ƒ báº¯t Ä‘áº§u" textFill="#888888">
                        <font><Font size="18.0" /></font>
                    </Label>
                </VBox>

                <VBox fx:id="chatArea" style="-fx-background-color: white;" visible="false">

                    <HBox alignment="CENTER_LEFT" spacing="15.0" style="-fx-border-color: #eee; -fx-border-width: 0 0 1 0;">
                        <padding><Insets top="15.0" right="20.0" bottom="15.0" left="20.0" /></padding>
                        <ImageView fx:id="partnerAvatarView" fitHeight="40.0" fitWidth="40.0" pickOnBounds="true" preserveRatio="true">
                            <clip><Circle centerX="20" centerY="20" radius="20" /></clip>
                        </ImageView>
                        <VBox alignment="CENTER_LEFT">
                            <Label fx:id="currentPartnerLabel" text="Username" textFill="#262626">
                                <font><Font name="System Bold" size="18.0" /></font>
                            </Label>
                            <Label text="Äang hoáº¡t Ä‘á»™ng" textFill="#888888" style="-fx-font-size: 12px;" />
                        </VBox>
                        <Region HBox.hgrow="ALWAYS" />
                        <Button onAction="#viewPartnerProfile" style="-fx-background-color: transparent; -fx-cursor: hand; -fx-text-fill: #fd267a;" text="Xem há»“ sÆ¡" />
                    </HBox>

                    <ListView fx:id="chatListView" styleClass="chat-list-view" VBox.vgrow="ALWAYS" />

                    <StackPane style="-fx-border-color: #eee; -fx-border-width: 1 0 0 0; -fx-padding: 10 20;">

                        <HBox fx:id="boxInputMessage" alignment="CENTER_LEFT" spacing="5.0" visible="true">

                            <Button onAction="#handleSendFile" style="-fx-background-color: transparent; -fx-cursor: hand; -fx-font-size: 20px; -fx-text-fill: #fd267a;" text="ðŸ“·">
                                <tooltip><Tooltip text="Gá»­i áº£nh"/></tooltip>
                            </Button>

                            <Button onAction="#handleSendDocument" style="-fx-background-color: transparent; -fx-cursor: hand; -fx-font-size: 20px; -fx-text-fill: #fd267a;" text="ðŸ“Ž">
                                <tooltip><Tooltip text="Gá»­i tÃ i liá»‡u"/></tooltip>
                            </Button>

                            <Button fx:id="btnEmoji" onAction="#handleEmoji" style="-fx-background-color: transparent; -fx-cursor: hand; -fx-font-size: 20px; -fx-text-fill: #fd267a;" text="ðŸ˜€">
                                <tooltip><Tooltip text="Emoji"/></tooltip>
                            </Button>

                            <Button onAction="#startRecordingUI" style="-fx-background-color: transparent; -fx-cursor: hand; -fx-font-size: 20px; -fx-text-fill: #fd267a;" text="ðŸŽ™">
                                <tooltip><Tooltip text="Ghi Ã¢m"/></tooltip>
                            </Button>

                            <TextField fx:id="messageInputField" onAction="#handleSendMessage" promptText="Nháº­p tin nháº¯n..." style="-fx-background-color: #f0f2f5; -fx-background-radius: 20; -fx-padding: 8 15; -fx-font-size: 14px;" HBox.hgrow="ALWAYS">
                                <HBox.margin><Insets left="5.0" right="5.0" /></HBox.margin>
                            </TextField>

                            <Button onAction="#handleSendMessage" style="-fx-background-color: transparent; -fx-cursor: hand; -fx-font-size: 22px; -fx-text-fill: #fd267a;" text="âž¤">
                                <tooltip><Tooltip text="Gá»­i tin nháº¯n"/></tooltip>
                            </Button>
                        </HBox>

                        <HBox fx:id="boxRecording" alignment="CENTER_LEFT" spacing="15.0" visible="false" style="-fx-background-color: white;">
                            <Button onAction="#cancelRecording" style="-fx-background-color: transparent; -fx-cursor: hand; -fx-text-fill: #666; -fx-font-size: 24px;" text="ðŸ—‘">
                                <tooltip><Tooltip text="Há»§y bá»"/></tooltip>
                            </Button>

                            <HBox alignment="CENTER_LEFT" spacing="10" HBox.hgrow="ALWAYS" style="-fx-background-color: #0084ff; -fx-background-radius: 25; -fx-padding: 5 15;">
                                <Label text="ðŸ”´" style="-fx-font-size: 14px; -fx-text-fill: white;" />
                                <Label text="Äang ghi Ã¢m..." textFill="WHITE" maxWidth="Infinity" HBox.hgrow="ALWAYS">
                                    <font><Font size="14.0"/></font>
                                </Label>
                                <Label fx:id="lblRecordingTimer" text="0:00" textFill="WHITE" style="-fx-font-weight: bold; -fx-font-size: 14px;" />
                            </HBox>

                            <Button onAction="#finishAndSendRecording" style="-fx-background-color: #0084ff; -fx-background-radius: 50%; -fx-min-width: 45px; -fx-min-height: 45px; -fx-cursor: hand; -fx-text-fill: white; -fx-font-size: 20px; -fx-font-weight: bold;" text="âž¤">
                                <tooltip><Tooltip text="Gá»­i ghi Ã¢m"/></tooltip>
                            </Button>
                        </HBox>

                    </StackPane>
                </VBox>
            </StackPane>
        </center>
    </BorderPane>

    <VBox fx:id="imageOverlay" visible="false" alignment="CENTER" style="-fx-background-color: rgba(0,0,0,0.8);" onMouseClicked="#closeImageOverlay">
        <ImageView fx:id="enlargedImageView" preserveRatio="true" fitHeight="600" fitWidth="800" />
        <Label text="Nháº¥n Ä‘á»ƒ Ä‘Ã³ng" textFill="WHITE" style="-fx-padding: 20;" />
    </VBox>

</StackPane>